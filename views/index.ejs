<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Sécurité des SI</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <style>
    .change {
      width: 100%;
      height: 20vh;
      border: 4px dashed #DDD;
      position: relative;
      border-radius: 5px;
    }

    .change::after {
      content: attr(data-text);
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #eee;
      font-size: 1.27rem;
      color: #777;
    }

    .change input {
      position: relative;
      width: 100%;
      z-index: 1000;
      height: 100%;
      opacity: 0;
    }
  </style>
</head>

<body>
  <!-- As a link -->
  <nav class="navbar navbar-dark bg-primary">
    <div class="container d-flex justify-content-between">
      <a class="navbar-brand" href="#">Encrypt/Decrypt files</a>
      <small class="text-white">By DJOPA & TANE</small>
    </div>
  </nav>
  <br><br><br>
  <br><br><br>
  <div class="container">
    <h2>
      1. Upload your file
    </h2>
    <br>
    <form action="file" method="post" id="files_form" enctype="multipart/form-data">
      <div class="form-group change" data-text="Upload your file here">
        <input class="" type="file" name="file" id="fichiers" required/>
      </div>
      <div class="form-group">
        <div class="progress  active">
          <div class="progress-bar pbar2 progress-bar-success progress-bar-striped" role="progressbar" aria-valuenow=""
            aria-valuemin="0" aria-valuemax="100" style="width: 0%">0%
          </div>
        </div>
      </div>
      <br><br><br>
      <div class="float-right">
        <button type="submit" class="btn btn-flat btn-primary">Next</button>
      </div>
    </form>
  </div>
   <script src="https://intranet.lamaterservice.com/airbus/public/assets/vendor/jquery/jquery-3.3.1.min.js"></script>
 
  </script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
  </script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
  </script>
<script src="http://malsup.github.com/jquery.form.js">
  </script>
  <script>
    $("#fichiers").change(function () {
      var files = document.querySelector("#fichiers").files;
      console.log(files)
      if (files.length > 0) {
        $(".change").attr("data-text", "")
      } else {
        $(".change").attr("data-text", "Déposez le fichier au format xlsx ici")
      }
      for (var i = 0; i < files.length; i++) {
        element = files[i];
        console.log(element);
        $(".change").attr("data-text",
          $(".change").attr("data-text") + " [" + element.name + "]")
      }
    })
    $(document).ready(function () {
     
      $('#files_form').ajaxForm({
        beforeSend: function () {
          $('#success').empty();
        },
        uploadProgress: function (event, position, total, percentComplete) {
          $('.pbar2').text(percentComplete + '%');
          $('.pbar2').css('width', percentComplete + '%');
        },
        success: function (data) { // alert(JSON.stringify(data)) 
          console.log(data)
          $('.pbar2').css('width', '100%'); // 
          $('#files form ').submit()
          if(data == "success"){
            document.location.href="/methods";
          }
         // window.location.reload() // alert("Fichier uploadé avec succès. Recharger la page pour voir") 
        }
      });
    })
  </script>
</body>

</html>